# Assembly of the Fabric

The DRRA-2 is a template system. Each fabric instance is assembled from components in a library according to an architecture description.

## DRRA Component Library

The DRRA component library is currently hosted on github at [drra-component-lib](https://github.com/silagokth/drra-component-lib). In the _lib_ folder, you can find the components for fabric, cells, controllers as well as resources.

To set up the component library, you can clone the repository, compile it and set up the environment variable `VESYLA_SUITE_PATH_COMPONENTS` to point to the compiled library folder.

```bash
git clone git@github.com:silagokth/drra-component-lib.git
cd drra-component-lib
mkdir build
cd build
cmake ..
make -j
export VESYLA_SUITE_PATH_COMPONENTS=$(pwd)/library
```

## Fabric Assembly

The fabric assembly is the process of generating the fabric instance from a user-defined architectural description file. The fabric instance is a collection of components from the component library. The assembly process will generate the fabric instance in the output directory.

The assembly process consists of the following steps:

1. Generate an elaborated architectural description file with expanded structural information.
2. Generate the ISA description file by collecting all the supported instructions from each used component.
3. Generate the RTL description file by collecting all the RTL descriptions from each used component.

To assemble the fabric, you can use the following command:

```bash
vesyla-suite component assemble -a user_defined_arch.json -o output_dir
```

After the command is executed, the output directory will contain three folders: _arch_, _isa_, and _rtl_. The _arch_ folder contains the elaborated architectural description file. The _isa_ folder contains the ISA description file. The _rtl_ folder contains the RTL description file.

### Architecture Description Assembly

The architecture description is a JSON file that describes the fabric instance. The user will define the input architectural description file according to the requirements of the application. Then the user will generate/elaborate the fabric instance and generate an elaborated architectural description file. This output file will be the basis of all the other assembly task of the fabric instance.

### ISA Description Assembly

The ISA description is a JSON file that describes the instruction set architecture of the fabric instance. The ISA description file is generated by collecting all the supported instructions from each used component in the fabric instance. This process will use the elaborated architectural description file as the input. Based on the used components, the ISA description of each component will be collected and merged into the final ISA description file.

### RTL Description Assembly

The RTL description consists of many system verilog files that describe the fabric instance. The RTL description file is generated by collecting all the RTL descriptions from each used component in the fabric instance. This process will use the elaborated architectural description file as the input.
