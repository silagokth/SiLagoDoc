


<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Documentation of SiLago project">
      
      
        <link rel="canonical" href="https://silagokth.github.io/SiLagoDoc/Docs/ToolChain/Vesyla-suite/VesylaProgrammingGuide_v2/">
      
      
        <meta name="author" content="SiLago Team">
      
      <link rel="shortcut icon" href="../../../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.1.2, mkdocs-material-5.0.2">
    
    
      
        <title>Vesyla Programming Guide (v2) - SiLago Documentation</title>
      
    
    
      <link rel="stylesheet" href="../../../../assets/stylesheets/main.c1a4d03f.min.css">
      
        <link rel="stylesheet" href="../../../../assets/stylesheets/palette.fdbf4049.min.css">
      
      
        
        
        <meta name="theme-color" content="#8bc34a">
      
    
    
    
      
        <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Lato:300,400,400i,700%7CRoboto+Mono&display=fallback">
        <style>body,input{font-family:"Lato",-apple-system,BlinkMacSystemFont,Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono",SFMono-Regular,Consolas,Menlo,monospace}</style>
      
    
    
    
    
      
    
    
  </head>
  
  
    
    
    <body dir="ltr" data-md-color-primary="light-green" data-md-color-accent="orange">
  
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#vesyla-programming-guide-v2" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid" aria-label="Header">
    <a href="https://silagokth.github.io/SiLagoDoc/" title="SiLago Documentation" class="md-header-nav__button md-logo" aria-label="SiLago Documentation">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12,8A3,3 0 0,0 15,5A3,3 0 0,0 12,2A3,3 0 0,0 9,5A3,3 0 0,0 12,8M12,11.54C9.64,9.35 6.5,8 3,8V19C6.5,19 9.64,20.35 12,22.54C14.36,20.35 17.5,19 21,19V8C17.5,8 14.36,9.35 12,11.54Z" /></svg>

    </a>
    <label class="md-header-nav__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3,6H21V8H3V6M3,11H21V13H3V11M3,16H21V18H3V16Z" /></svg>
    </label>
    <div class="md-header-nav__title" data-md-component="header-title">
      
        <div class="md-header-nav__ellipsis">
          <span class="md-header-nav__topic md-ellipsis">
            SiLago Documentation
          </span>
          <span class="md-header-nav__topic md-ellipsis">
            
              Vesyla Programming Guide (v2)
            
          </span>
        </div>
      
    </div>
    
      <label class="md-header-nav__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5,3A6.5,6.5 0 0,1 16,9.5C16,11.11 15.41,12.59 14.44,13.73L14.71,14H15.5L20.5,19L19,20.5L14,15.5V14.71L13.73,14.44C12.59,15.41 11.11,16 9.5,16A6.5,6.5 0 0,1 3,9.5A6.5,6.5 0 0,1 9.5,3M9.5,5C7,5 5,7 5,9.5C5,12 7,14 9.5,14C12,14 14,12 14,9.5C14,7 12,5 9.5,5Z" /></svg>
      </label>
      
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" data-md-state="active">
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5,3A6.5,6.5 0 0,1 16,9.5C16,11.11 15.41,12.59 14.44,13.73L14.71,14H15.5L20.5,19L19,20.5L14,15.5V14.71L13.73,14.44C12.59,15.41 11.11,16 9.5,16A6.5,6.5 0 0,1 3,9.5A6.5,6.5 0 0,1 9.5,3M9.5,5C7,5 5,7 5,9.5C5,12 7,14 9.5,14C12,14 14,12 14,9.5C14,7 12,5 9.5,5Z" /></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20,11V13H8L13.5,18.5L12.08,19.92L4.16,12L12.08,4.08L13.5,5.5L8,11H20Z" /></svg>
      </label>
      <button type="reset" class="md-search__icon md-icon" aria-label="Clear" data-md-component="search-reset" tabindex="-1">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19,6.41L17.59,5L12,10.59L6.41,5L5,6.41L10.59,12L5,17.59L6.41,19L12,13.41L17.59,19L19,17.59L13.41,12L19,6.41Z" /></svg>
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Type to start searching
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header-nav__source">
        
<a href="https://github.com/silagokth/SiLagoDoc/" title="Go to repository" class="md-source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05L244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    silagokth/SiLagoDoc
  </div>
</a>
      </div>
    
  </nav>
</header>
    
    <div class="md-container" data-md-component="container">
      
        
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="https://silagokth.github.io/SiLagoDoc/" title="SiLago Documentation" class="md-nav__button md-logo" aria-label="SiLago Documentation">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12,8A3,3 0 0,0 15,5A3,3 0 0,0 12,2A3,3 0 0,0 9,5A3,3 0 0,0 12,8M12,11.54C9.64,9.35 6.5,8 3,8V19C6.5,19 9.64,20.35 12,22.54C14.36,20.35 17.5,19 21,19V8C17.5,8 14.36,9.35 12,11.54Z" /></svg>

    </a>
    SiLago Documentation
  </label>
  
    <div class="md-nav__source">
      
<a href="https://github.com/silagokth/SiLagoDoc/" title="Go to repository" class="md-source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05L244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    silagokth/SiLagoDoc
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item">
    <a href="../../../.." title="Home" class="md-nav__link">
      Home
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-2" type="checkbox" id="nav-2">
    
    <label class="md-nav__link" for="nav-2">
      Guideline
      <span class="md-nav__icon md-icon">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M8.59,16.58L13.17,12L8.59,7.41L10,6L16,12L10,18L8.59,16.58Z" /></svg>
      </span>
    </label>
    <nav class="md-nav" aria-label="Guideline" data-md-level="1">
      <label class="md-nav__title" for="nav-2">
        <span class="md-nav__icon md-icon">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20,11V13H8L13.5,18.5L12.08,19.92L4.16,12L12.08,4.08L13.5,5.5L8,11H20Z" /></svg>
        </span>
        Guideline
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../Guideline/Mkdocs-tutorial/" title="MkDocs Tutorial" class="md-nav__link">
      MkDocs Tutorial
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../Guideline/Style-guide-cpp/" title="C++ Style Guide" class="md-nav__link">
      C++ Style Guide
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../Guideline/Style-guide-rtl/" title="Coding Guidelines for RTL and VHDL coding" class="md-nav__link">
      Coding Guidelines for RTL and VHDL coding
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      

  


  <li class="md-nav__item md-nav__item--active md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-3" type="checkbox" id="nav-3" checked>
    
    <label class="md-nav__link" for="nav-3">
      Docs
      <span class="md-nav__icon md-icon">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M8.59,16.58L13.17,12L8.59,7.41L10,6L16,12L10,18L8.59,16.58Z" /></svg>
      </span>
    </label>
    <nav class="md-nav" aria-label="Docs" data-md-level="1">
      <label class="md-nav__title" for="nav-3">
        <span class="md-nav__icon md-icon">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20,11V13H8L13.5,18.5L12.08,19.92L4.16,12L12.08,4.08L13.5,5.5L8,11H20Z" /></svg>
        </span>
        Docs
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          

  


  <li class="md-nav__item md-nav__item--active md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-3-1" type="checkbox" id="nav-3-1" checked>
    
    <label class="md-nav__link" for="nav-3-1">
      Tool Chain
      <span class="md-nav__icon md-icon">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M8.59,16.58L13.17,12L8.59,7.41L10,6L16,12L10,18L8.59,16.58Z" /></svg>
      </span>
    </label>
    <nav class="md-nav" aria-label="Tool Chain" data-md-level="2">
      <label class="md-nav__title" for="nav-3-1">
        <span class="md-nav__icon md-icon">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20,11V13H8L13.5,18.5L12.08,19.92L4.16,12L12.08,4.08L13.5,5.5L8,11H20Z" /></svg>
        </span>
        Tool Chain
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../Overview/" title="Toolchain for SiLago Platform" class="md-nav__link">
      Toolchain for SiLago Platform
    </a>
  </li>

        
          
          
          

  


  <li class="md-nav__item md-nav__item--active md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-3-1-2" type="checkbox" id="nav-3-1-2" checked>
    
    <label class="md-nav__link" for="nav-3-1-2">
      Vesyla-suite
      <span class="md-nav__icon md-icon">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M8.59,16.58L13.17,12L8.59,7.41L10,6L16,12L10,18L8.59,16.58Z" /></svg>
      </span>
    </label>
    <nav class="md-nav" aria-label="Vesyla-suite" data-md-level="3">
      <label class="md-nav__title" for="nav-3-1-2">
        <span class="md-nav__icon md-icon">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20,11V13H8L13.5,18.5L12.08,19.92L4.16,12L12.08,4.08L13.5,5.5L8,11H20Z" /></svg>
        </span>
        Vesyla-suite
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../Overview/" title="Vesyla-suite Overview" class="md-nav__link">
      Vesyla-suite Overview
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Installation/" title="Installation" class="md-nav__link">
      Installation
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Tutorial_DRRA/" title="DRRA-based AlImp Design Tutorial (v3)" class="md-nav__link">
      DRRA-based AlImp Design Tutorial (v3)
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Tutorial_DRRA_v2/" title="DRRA-based AlImp Design Tutorial (v2)" class="md-nav__link">
      DRRA-based AlImp Design Tutorial (v2)
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../VesylaProgrammingGuide/" title="Vesyla Programming Guide (v3)" class="md-nav__link">
      Vesyla Programming Guide (v3)
    </a>
  </li>

        
          
          
          

  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
    
      
    
    
      <label class="md-nav__link md-nav__link--active" for="__toc">
        Vesyla Programming Guide (v2)
        <span class="md-nav__icon md-icon">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3,9H17V7H3V9M3,13H17V11H3V13M3,17H17V15H3V17M19,17H21V15H19V17M19,7V9H21V7H19M19,13H21V11H19V13Z" /></svg>
        </span>
      </label>
    
    <a href="./" title="Vesyla Programming Guide (v2)" class="md-nav__link md-nav__link--active">
      Vesyla Programming Guide (v2)
    </a>
    
      
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20,11V13H8L13.5,18.5L12.08,19.92L4.16,12L12.08,4.08L13.5,5.5L8,11H20Z" /></svg>
      </span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#basics" class="md-nav__link">
    Basics
  </a>
  
    <nav class="md-nav" aria-label="Basics">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#general-guide" class="md-nav__link">
    General Guide
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pragma" class="md-nav__link">
    Pragma
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#variable-declaration" class="md-nav__link">
    Variable Declaration
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#vector-slicing-and-address-generation" class="md-nav__link">
    Vector Slicing and Address Generation
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#arithmetic-operation" class="md-nav__link">
    Arithmetic Operation
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#static-loop" class="md-nav__link">
    Static Loop
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dynamic-loop" class="md-nav__link">
    Dynamic Loop
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#branch" class="md-nav__link">
    Branch
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#address-constraint" class="md-nav__link">
    Address Constraint
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#advanced-features" class="md-nav__link">
    Advanced Features
  </a>
  
    <nav class="md-nav" aria-label="Advanced Features">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#macro" class="md-nav__link">
    Macro
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#primitive-function" class="md-nav__link">
    Primitive Function
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#resource-sharing-region" class="md-nav__link">
    Resource Sharing Region
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dpu-chain" class="md-nav__link">
    DPU Chain
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dpu-internal-scalar-register" class="md-nav__link">
    DPU Internal Scalar Register
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#not-supported" class="md-nav__link">
    Not Supported
  </a>
  
</li>
      
    </ul>
  
</nav>
    
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../ManasProgrammingGuide/" title="Manas Programming Guide" class="md-nav__link">
      Manas Programming Guide
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../InstructionSet/" title="Instruction Set" class="md-nav__link">
      Instruction Set
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../InstructionPhase/" title="Instruction Phase" class="md-nav__link">
      Instruction Phase
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Tutorial_RISCV/" title="RISCV-based AlImp Design Tutorial" class="md-nav__link">
      RISCV-based AlImp Design Tutorial
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../RepoOrganization/" title="Repo Organization" class="md-nav__link">
      Repo Organization
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
      </ul>
    </nav>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-4" type="checkbox" id="nav-4">
    
    <label class="md-nav__link" for="nav-4">
      About
      <span class="md-nav__icon md-icon">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M8.59,16.58L13.17,12L8.59,7.41L10,6L16,12L10,18L8.59,16.58Z" /></svg>
      </span>
    </label>
    <nav class="md-nav" aria-label="About" data-md-level="1">
      <label class="md-nav__title" for="nav-4">
        <span class="md-nav__icon md-icon">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20,11V13H8L13.5,18.5L12.08,19.92L4.16,12L12.08,4.08L13.5,5.5L8,11H20Z" /></svg>
        </span>
        About
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../About/About/" title="About" class="md-nav__link">
      About
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../About/License/" title="License" class="md-nav__link">
      License
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20,11V13H8L13.5,18.5L12.08,19.92L4.16,12L12.08,4.08L13.5,5.5L8,11H20Z" /></svg>
      </span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#basics" class="md-nav__link">
    Basics
  </a>
  
    <nav class="md-nav" aria-label="Basics">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#general-guide" class="md-nav__link">
    General Guide
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pragma" class="md-nav__link">
    Pragma
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#variable-declaration" class="md-nav__link">
    Variable Declaration
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#vector-slicing-and-address-generation" class="md-nav__link">
    Vector Slicing and Address Generation
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#arithmetic-operation" class="md-nav__link">
    Arithmetic Operation
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#static-loop" class="md-nav__link">
    Static Loop
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dynamic-loop" class="md-nav__link">
    Dynamic Loop
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#branch" class="md-nav__link">
    Branch
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#address-constraint" class="md-nav__link">
    Address Constraint
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#advanced-features" class="md-nav__link">
    Advanced Features
  </a>
  
    <nav class="md-nav" aria-label="Advanced Features">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#macro" class="md-nav__link">
    Macro
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#primitive-function" class="md-nav__link">
    Primitive Function
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#resource-sharing-region" class="md-nav__link">
    Resource Sharing Region
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dpu-chain" class="md-nav__link">
    DPU Chain
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dpu-internal-scalar-register" class="md-nav__link">
    DPU Internal Scalar Register
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#not-supported" class="md-nav__link">
    Not Supported
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                  <a href="https://github.com/silagokth/SiLagoDoc/edit/master/docs/Docs/ToolChain/Vesyla-suite/VesylaProgrammingGuide_v2.md" title="Edit this page" class="md-content__button md-icon">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20.71,7.04C21.1,6.65 21.1,6 20.71,5.63L18.37,3.29C18,2.9 17.35,2.9 16.96,3.29L15.12,5.12L18.87,8.87M3,17.25V21H6.75L17.81,9.93L14.06,6.18L3,17.25Z" /></svg>
                  </a>
                
                
                  
                
                
                <h1 id="vesyla-programming-guide-v2">Vesyla Programming Guide (v2)</h1>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This page is written for vesyla-suite <strong>version 2</strong>. It's deprecated and will be removed soon. You should only use it for old project such as DRRA characterization. For vesyla-suite version 3, please see <a href="../VesylaProgrammingGuide">Vesyla Programming Guide</a>.</p>
</div>
<h2 id="basics">Basics</h2>
<h3 id="general-guide">General Guide</h3>
<p>Vesyla accept modified matlab code as input language. You shouldn't write the matlab code like a programming language. You should instead use it as a tool to model the behaviour of the hardware. Vesyla supports small portion of matlab grammar. There are some generic rules expressing the programming style vesyla accepts.</p>
<ul>
<li>General function call is not allowed unless the function is predefined as primitive function.</li>
<li>Variable except for constant variable and loop iterator should always be decleared via pragma.</li>
<li>Statement should always ends with semicolon (<code>;</code>) to avoid unexpected outputs while simulating in matlab.</li>
<li>Constant number is normally treated as integers, not double floating point.</li>
</ul>
<h3 id="pragma">Pragma</h3>
<p>Pragma is the notation that guides Vesyla during synthesis process. Vesyla recongnize pragma starting with symbols <code>%!</code>. The main function of pragmas is specify allocation and binding information since Vesyla can't perform automatic allocation and binding. Section <a href="#variable-declaration">Variable Declaration</a>, <a href="#arithmetic-operation">Arithmetic Operation</a>, <a href="#address-constraint">Address Constraint</a> <a href="#dpu_chain">DPU Chain</a> and <a href="#dpu-internal-scalar-register">DPU Internal Scalar Register</a> describe how to use pragmas to allocate and bind resources. Some other usage of pragma also exist, check section <a href="#resource-sharing-region">Resource Sharing Region</a> for more detail.</p>
<h3 id="variable-declaration">Variable Declaration</h3>
<p>Variables supported by Vesyla are vectored Register file variables and SRAM variables. Register file variables will bind to register file and SRAM variables will bind to DiMArch. Since matlab dosen't require variable declaration, we need to give initial value to declare them. You can use the standard initialization assignment for matlab <strong>1-D</strong> arry to declare a variable. Function such as <code>zeros()</code> and  <code>ones()</code> are also supported.</p>
<p>To declear SRAM variable, you need to use <code>%! MEM[row, col]</code> pragma. <code>row</code> and <code>col</code> are the coordinate of the SRAM block you want to bind for this variable. SRAM usually organized as a 2-D bit matrix without bit-level and word-level access. Data communication with SRAM happens in bulk mode where each data exchange need to be a complete SRAM row. Suppose SRAM with is <span><span class="MathJax_Preview">N</span><script type="math/tex">N</script></span> and Register width (1 word) is <span><span class="MathJax_Preview">M</span><script type="math/tex">M</script></span> bit. Each SRAM row will have <span><span class="MathJax_Preview">N/M</span><script type="math/tex">N/M</script></span> words. Typical value for <span><span class="MathJax_Preview">M</span><script type="math/tex">M</script></span> and <span><span class="MathJax_Preview">N</span><script type="math/tex">N</script></span> are <span><span class="MathJax_Preview">M=256</span><script type="math/tex">M=256</script></span> and <span><span class="MathJax_Preview">N=16</span><script type="math/tex">N=16</script></span>. Since SRAM only support whole line reading and writing, the SRAM variable you defined should always have multiple of <span><span class="MathJax_Preview">M/N</span><script type="math/tex">M/N</script></span> elements.</p>
<div class="admonition example">
<p class="admonition-title">Example</p>
<p>The example shows how to define a SRAM variable <code>y</code> on SRAM block <code>[0,0]</code>. <code>y</code> is initialized by a 1-D vector <code>[1,2,3,4,5,...,16]</code>.
<div class="highlight"><pre><span></span><code><span class="n">y</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="mi">16</span><span class="p">];</span><span class="w"> </span><span class="c">%! MEM[0,0]</span><span class="w"></span>
</code></pre></div></p>
</div>
<p>To declear register file variable, you need to use <code>%! RFIL[row, col]</code> pragma. <code>row</code> and <code>col</code> are the coordinate of the DRRA cell you want to bind for this variable. Unlike SRAM, register file is organized in the way that each row will always represent a word. So there is no restriction on the size of register file variable as long as it doesn't exceed the register depth limit.</p>
<div class="admonition example">
<p class="admonition-title">Example</p>
<p>The example shows how to define a register file variable <code>x</code> on DRRA cell <code>[0,0]</code>.<code>x</code> has 5 elements and is initialized by a <code>zeros()</code> function which will set all elements in <code>x</code> to <code>0</code>.
<div class="highlight"><pre><span></span><code><span class="n">x</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nb">zeros</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">5</span><span class="p">);</span><span class="w"> </span><span class="c">%! REFI[0,0]</span><span class="w"></span>
</code></pre></div></p>
</div>
<p>For debugging purpose, vesyla allows initialization of register file variable. However, register should not be initialized with any value other than zeros because the real DRRA cell doesn't have interface to support the register initalization. Register file variables hence should always get data from SRAM variables.</p>
<div class="admonition error">
<p class="admonition-title">Error</p>
<p>The following variable declaration style is incorrect:</p>
<ol>
<li>No storage pragma specified
<div class="highlight"><pre><span></span><code><span class="n">x</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nb">zeros</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">5</span><span class="p">);</span><span class="w"></span>
</code></pre></div></li>
<li>Initialized to scalar
<div class="highlight"><pre><span></span><code><span class="n">x</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span><span class="w"> </span><span class="c">%! RFILE[1,1]</span><span class="w"></span>
</code></pre></div></li>
<li>Initialized to 2-D array
<div class="highlight"><pre><span></span><code><span class="n">x</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nb">ones</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">);</span><span class="w"> </span><span class="c">%! RFILE[1,1]</span><span class="w"></span>
</code></pre></div></li>
<li>SRAM varible is not the size of SRAM row
<div class="highlight"><pre><span></span><code><span class="n">x</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="mi">3</span><span class="p">];</span><span class="w"> </span><span class="c">%! MEM[0,1]</span><span class="w"></span>
</code></pre></div></li>
<li>Initialization function <code>randi()</code> is not supported
<div class="highlight"><pre><span></span><code><span class="n">x</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nb">randi</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">16</span><span class="p">);</span><span class="w"> </span><span class="c">%! MEM[0,1]</span><span class="w"></span>
</code></pre></div></li>
</ol>
</div>
<h3 id="vector-slicing-and-address-generation">Vector Slicing and Address Generation</h3>
<p>Each DPU can only process one scalar data each time, so the vectored register variable should be slice first before sending to DPU. The slicing operation is mapped on AGU by REFI instruction. While writing matlab code, you don't have to worry about the slicing since matlab directly support vector slicing.</p>
<p>Here is an example of slicing a vector:</p>
<div class="admonition example">
<p class="admonition-title">Example</p>
<div class="highlight"><pre><span></span><code><span class="n">x</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="mi">5</span><span class="p">];</span><span class="w"> </span><span class="c">%! REFI[0,0]</span><span class="w"></span>
<span class="n">y</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="mi">5</span><span class="p">];</span><span class="w"> </span><span class="c">%! REFI[0,0]</span><span class="w"></span>
<span class="hll"><span class="n">y</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">5</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">x</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">5</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">y</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">5</span><span class="p">);</span><span class="w"> </span><span class="c">%! DPU[0,0]</span><span class="w"></span>
</span></code></pre></div>
</div>
<p>If you don't use any slicing and directly feed a vectored register variable to arithmetic operaion, Vesyla will use the full range of that variable.</p>
<p>When slicing a SRAM varialbe, the minimal slice should always be multiple of 16.</p>
<p>Except for the matlab default slicing method, you can also use two primitive AGU function to linear slice a vectored varialbe both in 1-D or 2-D. Example is given below. All address sequence in the following example are "1,2,3,4,5".</p>
<div class="admonition example">
<p class="admonition-title">Example</p>
<div class="highlight"><pre><span></span><code><span class="n">x</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="mi">5</span><span class="p">];</span><span class="w"> </span><span class="c">%! REFI[0,0]</span><span class="w"></span>
<span class="n">y</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="mi">5</span><span class="p">];</span><span class="w"> </span><span class="c">%! REFI[0,0]</span><span class="w"></span>
<span class="hll"><span class="n">y</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">5</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">x</span><span class="p">(</span><span class="n">silago_agu_linear_1d</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">y</span><span class="p">(</span><span class="n">silago_agu_linear_2d</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">5</span><span class="p">));</span><span class="w"> </span><span class="c">%! DPU[0,0]</span><span class="w"></span>
</span></code></pre></div>
</div>
<h3 id="arithmetic-operation">Arithmetic Operation</h3>
<p>Certain type of arithmetic operations are supported by Vesyla. They are addition, subtraction, dot multiplication, sum, abs, etc. Special arithmetic operation need to be mapped to special DPU mode by primitive function call, see section <a href="#primitive-function">Primitive Function</a>.</p>
<div class="admonition bug">
<p class="admonition-title">Bug</p>
<p>Symbol <code>~</code> is not supported yet!</p>
</div>
<p>For arithmetic assignment, you can have a multiple variables as output depending on the DPU mode. The ignored output can be muted by symbol <code>~</code>.</p>
<p>Arithmetic operation need a computation resource to perform required operation, that is the DPU. So, every arithmetic operation need to bind to a DPU resource via pragma.</p>
<p>Example of an arithmetic assignment is demonstrated as following:</p>
<div class="admonition example">
<p class="admonition-title">Example</p>
<div class="highlight"><pre><span></span><code><span class="n">x</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="mi">5</span><span class="p">];</span><span class="w"> </span><span class="c">%! REFI[0,0]</span><span class="w"></span>
<span class="n">y</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="mi">5</span><span class="p">];</span><span class="w"> </span><span class="c">%! REFI[0,0]</span><span class="w"></span>
<span class="hll"><span class="n">y</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">5</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">x</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">5</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">y</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">5</span><span class="p">);</span><span class="w"> </span><span class="c">%! DPU[0,0]</span><span class="w"></span>
</span></code></pre></div>
</div>
<h3 id="static-loop">Static Loop</h3>
<p>Vesyla accept all static loops. A static loop should have constant start point, static increment as well as static iteration. If an expression that can be simplified to a constant number, it also considered as constant, hence can be used in static loop. Example below shows how to use a static loop.</p>
<div class="admonition example">
<p class="admonition-title">Example</p>
<div class="highlight"><pre><span></span><code><span class="n">n</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">3</span><span class="p">;</span><span class="w"></span>
<span class="hll"><span class="k">for</span><span class="w"> </span><span class="nb">i</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">1</span><span class="p">:</span><span class="mi">1</span><span class="p">:</span><span class="n">n</span><span class="o">+</span><span class="mi">1</span><span class="w"></span>
</span><span class="w">    </span><span class="k">...</span><span class="w"></span>
<span class="hll"><span class="k">end</span><span class="w"></span>
</span></code></pre></div>
</div>
<h3 id="dynamic-loop">Dynamic Loop</h3>
<p>Vesyla support limited dynamic loops. Dynamic loop can have dynamic start point, and dynamic iteration. However, those number should be in address domain, a.k.a computed by RACCU and is fully determinastic after unrolling all the loops.</p>
<p>Example of such dynamic loop is shown below:</p>
<div class="admonition example">
<p class="admonition-title">Example</p>
<div class="highlight"><pre><span></span><code><span class="k">for</span><span class="w"> </span><span class="nb">i</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">1</span><span class="p">:</span><span class="mi">1</span><span class="p">:</span><span class="mi">4</span><span class="w"></span>
<span class="hll"><span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="nb">j</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nb">i</span><span class="p">:</span><span class="mi">1</span><span class="p">:</span><span class="nb">i</span><span class="o">+</span><span class="mi">3</span><span class="w"></span>
</span><span class="w">        </span><span class="k">...</span><span class="w"></span>
<span class="w">    </span><span class="k">end</span><span class="w"></span>
<span class="k">end</span><span class="w"></span>
</code></pre></div>
</div>
<h3 id="branch">Branch</h3>
<p>Vesyla support normal matlab branch except for both operands of condition are constants. The usage of branch is the same as the original matlab code. For example:</p>
<div class="admonition example">
<p class="admonition-title">Example</p>
<div class="highlight"><pre><span></span><code><span class="n">x</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="mi">5</span><span class="p">];</span><span class="w"> </span><span class="c">%! REFI[0,0]</span><span class="w"></span>
<span class="n">y</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="mi">5</span><span class="p">];</span><span class="w"> </span><span class="c">%! REFI[0,0]</span><span class="w"></span>
<span class="n">w</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="p">[</span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="mi">5</span><span class="p">];</span><span class="w"> </span><span class="c">%! REFI[0,0]</span><span class="w"></span>
<span class="hll"><span class="k">if</span><span class="w"> </span><span class="n">w</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">w</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="w"></span>
</span><span class="w">    </span><span class="n">y</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">x</span><span class="p">;</span><span class="w"></span>
<span class="hll"><span class="k">else</span><span class="w"></span>
</span><span class="w">    </span><span class="n">y</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">x</span><span class="o">+</span><span class="n">y</span><span class="p">;</span><span class="w"> </span><span class="c">%! DPU[0,0]</span><span class="w"></span>
<span class="hll"><span class="k">end</span><span class="w"></span>
</span></code></pre></div>
</div>
<h3 id="address-constraint">Address Constraint</h3>
<p>Address constraints are parameters used by address generation in AGU. Address constraints can be constant or RACCU variable calculated at run-time in RACCU. Dynamic address constraint variables are usually used in loops. Example below shows how to use a RACCU variable to serve as address constraint.</p>
<div class="admonition example">
<p class="admonition-title">Example</p>
<div class="highlight"><pre><span></span><code><span class="n">x</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="mi">5</span><span class="p">];</span><span class="w"> </span><span class="c">%! REFI[0,0]</span><span class="w"></span>
<span class="n">y</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="mi">16</span><span class="p">];</span><span class="w"> </span><span class="c">%! REFI[0,0]</span><span class="w"></span>
<span class="hll"><span class="n">a</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span><span class="w"> </span><span class="c">%! RACCU_VAR</span><span class="w"></span>
</span><span class="k">for</span><span class="w"> </span><span class="nb">i</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">1</span><span class="p">:</span><span class="mi">1</span><span class="p">:</span><span class="mi">4</span><span class="w"></span>
<span class="hll"><span class="w">    </span><span class="n">y</span><span class="p">(</span><span class="n">a</span><span class="o">+</span><span class="mi">1</span><span class="p">:</span><span class="n">a</span><span class="o">+</span><span class="mi">1</span><span class="o">+</span><span class="mi">5</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">x</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">5</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">y</span><span class="p">(</span><span class="n">a</span><span class="p">:</span><span class="n">a</span><span class="o">+</span><span class="mi">5</span><span class="p">);</span><span class="w"> </span><span class="c">%! DPU[0,0]</span><span class="w"></span>
</span><span class="w">    </span><span class="n">a</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">a</span><span class="o">+</span><span class="mi">1</span><span class="p">;</span><span class="w"></span>
<span class="k">end</span><span class="w"></span>
</code></pre></div>
</div>
<h2 id="advanced-features">Advanced Features</h2>
<h3 id="macro">Macro</h3>
<p>Vesyla support symbolic expression to enable fast design space exploration. One of the technique is to use macros. Before the lexecal analysis, vesyla will expand all macro to normal program code. Macro gives programmer the tool to generate multiple program with small variations.</p>
<p>Programmer need to provide a template and a series of data. Data is organized in json format and will be loaded in to evaluate those macros defined in template. Template use a grammar like the templating package <a href="https://github.com/pantor/inja">inja</a>. Infact, vesyla directly use inja library to evaluate macros.</p>
<p>Example below demonstrate how to define a loop in template:</p>
<div class="admonition example">
<p class="admonition-title">Example</p>
<p>An template file defined as following:</p>
<div class="highlight"><pre><span></span><code><span class="p">{</span><span class="c">% for x in range(par_col) %}</span><span class="w"></span>
<span class="n">x0_mem_</span><span class="p">{{</span><span class="n">x</span><span class="p">}}</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="p">[</span><span class="mi">1</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">n</span><span class="o">/</span><span class="n">col</span><span class="p">];</span><span class="w"> </span><span class="c">%! MEM[0, {{x}}]</span><span class="w"></span>
<span class="n">y0_mem_</span><span class="p">{{</span><span class="n">x</span><span class="p">}}</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="p">[</span><span class="mi">1</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">n</span><span class="o">/</span><span class="n">col</span><span class="p">];</span><span class="w"> </span><span class="c">%! MEM[0, {{x}}]</span><span class="w"></span>
<span class="p">{</span><span class="c">% endfor %}</span><span class="w"></span>
</code></pre></div>
<p>With a json-formated data file:</p>
<div class="highlight"><pre><span></span><code><span class="p">{</span><span class="nt">&quot;par_col&quot;</span> <span class="p">:</span> <span class="mi">2</span><span class="p">}</span>
</code></pre></div>
<p>This template will generate a real matlab code as following by expanding the FOR-LOOP macro:</p>
<div class="highlight"><pre><span></span><code><span class="n">x0_mem_0</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="p">[</span><span class="mi">1</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">n</span><span class="o">/</span><span class="n">col</span><span class="p">];</span><span class="w"> </span><span class="c">%! MEM[0, 0]</span><span class="w"></span>
<span class="n">y0_mem_0</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="p">[</span><span class="mi">1</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">n</span><span class="o">/</span><span class="n">col</span><span class="p">];</span><span class="w"> </span><span class="c">%! MEM[0, 0]</span><span class="w"></span>
<span class="n">x0_mem_1</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="p">[</span><span class="mi">1</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">n</span><span class="o">/</span><span class="n">col</span><span class="p">];</span><span class="w"> </span><span class="c">%! MEM[0, 1]</span><span class="w"></span>
<span class="n">y0_mem_1</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="p">[</span><span class="mi">1</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">n</span><span class="o">/</span><span class="n">col</span><span class="p">];</span><span class="w"> </span><span class="c">%! MEM[0, 1]</span><span class="w"></span>
</code></pre></div>
</div>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>More complex usage please visit <a href="https://github.com/pantor/inja">inja</a> website.</p>
</div>
<h3 id="primitive-function">Primitive Function</h3>
<p>Primitive DPU functions are functions that corresponds to a complete DPU mode. Different DPUs targeting on different application domain may have some special modes specifically made for such application domain. For example, sigmoid function for neural network application. Those primitive function is not directly supported by matlab, but they are supported by vesyla.</p>
<p>To use a specific DPU mode as primitive function, first you need to make sure the DRRA cell you are using has such mode. Then you need to change the configuration of vesyla to recongnize such mode. The configuration file is <em>$Vesyla_root/config/primitive_func_def.xml</em>. Finally, you can use the function inside your program.</p>
<p>All primitive DPU functions have name should start with <em>silago_dpu_</em> to be accepted by Vesyla.</p>
<p>Example of using primitive DPU function:</p>
<div class="admonition example">
<p class="admonition-title">Example</p>
<div class="highlight"><pre><span></span><code><span class="n">x</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="mi">5</span><span class="p">];</span><span class="w"> </span><span class="c">%! REFI[0,0]</span><span class="w"></span>
<span class="hll"><span class="n">x</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">silago_dpu_sigmoid</span><span class="p">(</span><span class="n">x</span><span class="p">);</span><span class="w"> </span><span class="c">%! DPU[0,0]</span><span class="w"></span>
</span></code></pre></div>
</div>
<p>AUGs also have special primitive functions to express the complex addressing mode. But AGU primitive functions are not custom. There are two AGU primitive function: <strong>silago_agu_linear_1d()</strong> and <strong>silago_agu_linear_2d()</strong>. More AGU primitive functions will be added if some application domain requires.</p>
<p>Example of using primitive DPU function:</p>
<div class="admonition example">
<p class="admonition-title">Example</p>
<div class="highlight"><pre><span></span><code><span class="n">x</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="mi">5</span><span class="p">];</span><span class="w"> </span><span class="c">%! REFI[0,0]</span><span class="w"></span>
<span class="n">a</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="p">[</span><span class="mi">1</span><span class="p">];</span><span class="w"> </span><span class="c">%! REFI[0,0]</span><span class="w"></span>
<span class="hll"><span class="n">x</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">a</span><span class="p">(</span><span class="n">silago_agu_linear_1d</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">5</span><span class="p">));</span><span class="w"> </span><span class="c">%! DPU[0,0]</span><span class="w"></span>
</span></code></pre></div>
</div>
<h3 id="resource-sharing-region">Resource Sharing Region</h3>
<p>When multiple operations need some common operands, due to the limit of the number of reading ports, those operations can't happen at the same time in normal condition. Resource sharing region tries to solve the problem. By enabling the broadcasting mechanism, all operation will recieve the same common operand at the same time generated by single reading port of the register file. The datapath of transmitting the common operand is now shared among those operations.</p>
<p>Resource sharing region requires a fixed datapath layout. Dynamic change of datapath structure is forbidden inside resource sharing region. So, you should only use it when needed.</p>
<p>Following example shows how to active resource sharing region.</p>
<div class="admonition example">
<p class="admonition-title">Example</p>
<div class="highlight"><pre><span></span><code><span class="n">x0</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="mi">5</span><span class="p">];</span><span class="w"> </span><span class="c">%! REFI[0,0]</span><span class="w"></span>
<span class="n">x1</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="mi">5</span><span class="p">];</span><span class="w"> </span><span class="c">%! REFI[1,0]</span><span class="w"></span>
<span class="n">a2</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="mi">5</span><span class="p">];</span><span class="w"> </span><span class="c">%! REFI[2,0]</span><span class="w"></span>
<span class="n">x3</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="mi">5</span><span class="p">];</span><span class="w"> </span><span class="c">%! REFI[3,0]</span><span class="w"></span>
<span class="n">x4</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="mi">5</span><span class="p">];</span><span class="w"> </span><span class="c">%! REFI[4,0]</span><span class="w"></span>

<span class="hll"><span class="c">%! RESOURCE_SHARING_BEGIN</span><span class="w"></span>
</span><span class="n">x0</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">x0</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">a2</span><span class="p">;</span><span class="w"> </span><span class="c">%! DPU[0,0]</span><span class="w"></span>
<span class="n">x1</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">x1</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">a2</span><span class="p">;</span><span class="w"> </span><span class="c">%! DPU[1,0]</span><span class="w"></span>
<span class="n">x3</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">x3</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">a2</span><span class="p">;</span><span class="w"> </span><span class="c">%! DPU[3,0]</span><span class="w"></span>
<span class="n">x4</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">x4</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">a2</span><span class="p">;</span><span class="w"> </span><span class="c">%! DPU[4,0]</span><span class="w"></span>
<span class="hll"><span class="c">%! RESOURCE_SHARING_END</span><span class="w"></span>
</span></code></pre></div>
</div>
<h3 id="dpu-chain">DPU Chain</h3>
<p>Datapath can be configured as a chain of DPU operation. The output of the previous DPU will immediately enter the next DPU without any register file involved in between. Consider we want to compute a vector addition and a sigmoid function: <span><span class="MathJax_Preview">z = \sigma (x+y)</span><script type="math/tex">z = \sigma (x+y)</script></span>. We can employ two DPUs to perform the complete operation in pipelined fashion. By writing the matlab like the following, you can enable the feature.</p>
<div class="admonition example">
<p class="admonition-title">Example</p>
<div class="highlight"><pre><span></span><code><span class="n">x</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="mi">5</span><span class="p">];</span><span class="w"> </span><span class="c">%! REFI[0,0]</span><span class="w"></span>
<span class="n">y</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="mi">5</span><span class="p">];</span><span class="w"> </span><span class="c">%! REFI[0,0]</span><span class="w"></span>
<span class="n">z</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="mi">5</span><span class="p">];</span><span class="w"> </span><span class="c">%! REFI[0,0]</span><span class="w"></span>
<span class="hll"><span class="n">t</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nb">zeros</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">5</span><span class="p">);</span><span class="w"> </span><span class="c">%! CDPU[0,0]</span><span class="w"></span>
</span>
<span class="hll"><span class="n">t</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">y</span><span class="p">;</span><span class="w"></span>
</span><span class="hll"><span class="n">z</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">silago_dpu_sigmoid</span><span class="p">(</span><span class="n">t</span><span class="p">);</span><span class="w"> </span><span class="c">%! DPU[1,0]</span><span class="w"></span>
</span></code></pre></div>
</div>
<h3 id="dpu-internal-scalar-register">DPU Internal Scalar Register</h3>
<p>Inside each DPU, there are <strong>two</strong> internal scalar registers which can be explicitly used via high-level matlab program. One can use them by declearing them with the pragma <code>%! CDPU[row, col]</code>.</p>
<p>The available functions to load and store values to/from internal scalar registers are:</p>
<div class="highlight"><pre><span></span><code><span class="n">r0</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">silago_dpu_load_reg_0</span><span class="p">(</span><span class="n">x</span><span class="p">(</span><span class="mi">1</span><span class="p">));</span><span class="w"></span>
<span class="n">r1</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">silago_dpu_load_reg_1</span><span class="p">(</span><span class="n">x</span><span class="p">(</span><span class="mi">1</span><span class="p">));</span><span class="w"></span>
<span class="p">[</span><span class="n">r0</span><span class="p">,</span><span class="w"> </span><span class="n">r1</span><span class="p">]</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">silago_dpu_load_reg_both</span><span class="p">(</span><span class="n">x</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="w"> </span><span class="n">x</span><span class="p">(</span><span class="mi">2</span><span class="p">));</span><span class="w"></span>
<span class="n">x</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">silago_dpu_load_store_0</span><span class="p">(</span><span class="n">r0</span><span class="p">);</span><span class="w"></span>
<span class="n">x</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">silago_dpu_load_store_1</span><span class="p">(</span><span class="n">r1</span><span class="p">);</span><span class="w"></span>
<span class="p">[</span><span class="n">x</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="w"> </span><span class="n">y</span><span class="p">(</span><span class="mi">1</span><span class="p">)]</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">silago_dpu_load_store_both</span><span class="p">(</span><span class="n">r0</span><span class="p">,</span><span class="w"> </span><span class="n">r1</span><span class="p">);</span><span class="w"></span>
</code></pre></div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Programmer should keep in mind that lifetime and physical location of those variable. Vesyla has very weak semantic checking on those internal scalar register variables.</p>
</div>
<div class="admonition example">
<p class="admonition-title">Example</p>
<p>For example, if one want to calculate a function: <span><span class="MathJax_Preview">y = ax.y</span><script type="math/tex">y = ax.y</script></span>. Instead of put the coefficient <span><span class="MathJax_Preview">a</span><script type="math/tex">a</script></span> inside a normal register and waste other register entries of the same register block, you can put the coefficient to the internal register, and configure DPU to a scaled multiplication mode to get the correct result.</p>
<div class="highlight"><pre><span></span><code><span class="n">a_mem</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="mi">16</span><span class="p">];</span><span class="w"> </span><span class="c">%! SRAM[0,0]</span><span class="w"></span>
<span class="n">x_mem</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="mi">16</span><span class="p">];</span><span class="w"> </span><span class="c">%! SRAM[0,0]</span><span class="w"></span>
<span class="n">y_mem</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="mi">16</span><span class="p">];</span><span class="w"> </span><span class="c">%! SRAM[0,0]</span><span class="w"></span>
<span class="n">x</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="mi">16</span><span class="p">];</span><span class="w"> </span><span class="c">%! REFI[0,0]</span><span class="w"></span>
<span class="n">y</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="mi">16</span><span class="p">];</span><span class="w"> </span><span class="c">%! REFI[0,0]</span><span class="w"></span>
<span class="hll"><span class="n">r</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nb">zeros</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">);</span><span class="w"> </span><span class="c">%! CDPU[0,0]</span><span class="w"></span>
</span>
<span class="n">x</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">a_mem</span><span class="p">;</span><span class="w"></span>
<span class="hll"><span class="n">r</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">silago_dpu_load_reg_1</span><span class="p">(</span><span class="n">x</span><span class="p">(</span><span class="mi">1</span><span class="p">));</span><span class="w"></span>
</span><span class="n">x</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">x_mem</span><span class="p">;</span><span class="w"></span>
<span class="n">y</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">y_mem</span><span class="p">;</span><span class="w"></span>
<span class="hll"><span class="n">y</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">silago_dpu_scaled_mul</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="p">,</span><span class="w"> </span><span class="n">r</span><span class="p">);</span><span class="w"> </span><span class="c">%! DPU[0,0]</span><span class="w"></span>
</span><span class="n">y_mem</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">y</span><span class="p">;</span><span class="w"></span>
</code></pre></div>
</div>
<h2 id="not-supported">Not Supported</h2>
<p>Some matlab code is not accepted by Vesyla because it can't execute on DRRA fabric. They are:</p>
<ul>
<li>While-loop.</li>
<li>For-loop inside branch.</li>
<li>Arithmetic statement that can't be mapped to single DPU mode.</li>
<li>Normal function call except for primitive function call.</li>
<li>Indirect addressing.</li>
</ul>
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid" aria-label="Footer">
        
          <a href="../VesylaProgrammingGuide/" title="Vesyla Programming Guide (v3)" class="md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-footer-nav__button md-icon">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20,11V13H8L13.5,18.5L12.08,19.92L4.16,12L12.08,4.08L13.5,5.5L8,11H20Z" /></svg>
            </div>
            <div class="md-footer-nav__title">
              <div class="md-ellipsis">
                <span class="md-footer-nav__direction">
                  Previous
                </span>
                Vesyla Programming Guide (v3)
              </div>
            </div>
          </a>
        
        
          <a href="../ManasProgrammingGuide/" title="Manas Programming Guide" class="md-footer-nav__link md-footer-nav__link--next" rel="next">
            <div class="md-footer-nav__title">
              <div class="md-ellipsis">
                <span class="md-footer-nav__direction">
                  Next
                </span>
                Manas Programming Guide
              </div>
            </div>
            <div class="md-footer-nav__button md-icon">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4,11V13H16L10.5,18.5L11.92,19.92L19.84,12L11.92,4.08L10.5,5.5L16,11H4Z" /></svg>
            </div>
          </a>
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
        Made with
        <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
          Material for MkDocs
        </a>
      </div>
      
    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../../../../assets/javascripts/vendor.606193c2.min.js"></script>
      <script src="../../../../assets/javascripts/bundle.b90b6d1d.min.js"></script><script id="__lang" type="application/json">{"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents"}</script>
      
      <script>
        app = initialize({
          base: "../../../..",
          features: [],
          search: Object.assign({
            worker: "../../../../assets/javascripts/worker/search.7f7c8775.min.js"
          }, typeof search !== "undefined" && search)
        })
      </script>
      
        <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-MML-AM_CHTML"></script>
      
    
  </body>
</html>