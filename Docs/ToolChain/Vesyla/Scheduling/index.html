


<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Documentation of SiLago project">
      
      
        <link rel="canonical" href="https://silagokth.github.io/SiLagoDoc/Docs/ToolChain/Vesyla/Scheduling/">
      
      
        <meta name="author" content="SiLago Team">
      
      <link rel="shortcut icon" href="../../../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.1.2, mkdocs-material-5.0.2">
    
    
      
        <title>Scheduling - SiLago Documentation</title>
      
    
    
      <link rel="stylesheet" href="../../../../assets/stylesheets/main.c1a4d03f.min.css">
      
        <link rel="stylesheet" href="../../../../assets/stylesheets/palette.fdbf4049.min.css">
      
      
        
        
        <meta name="theme-color" content="#8bc34a">
      
    
    
    
      
        <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Lato:300,400,400i,700%7CRoboto+Mono&display=fallback">
        <style>body,input{font-family:"Lato",-apple-system,BlinkMacSystemFont,Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono",SFMono-Regular,Consolas,Menlo,monospace}</style>
      
    
    
    
    
      
    
    
  </head>
  
  
    
    
    <body dir="ltr" data-md-color-primary="light-green" data-md-color-accent="orange">
  
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#scheduling" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid" aria-label="Header">
    <a href="https://silagokth.github.io/SiLagoDoc/" title="SiLago Documentation" class="md-header-nav__button md-logo" aria-label="SiLago Documentation">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12,8A3,3 0 0,0 15,5A3,3 0 0,0 12,2A3,3 0 0,0 9,5A3,3 0 0,0 12,8M12,11.54C9.64,9.35 6.5,8 3,8V19C6.5,19 9.64,20.35 12,22.54C14.36,20.35 17.5,19 21,19V8C17.5,8 14.36,9.35 12,11.54Z" /></svg>

    </a>
    <label class="md-header-nav__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3,6H21V8H3V6M3,11H21V13H3V11M3,16H21V18H3V16Z" /></svg>
    </label>
    <div class="md-header-nav__title" data-md-component="header-title">
      
        <div class="md-header-nav__ellipsis">
          <span class="md-header-nav__topic md-ellipsis">
            SiLago Documentation
          </span>
          <span class="md-header-nav__topic md-ellipsis">
            
              Scheduling
            
          </span>
        </div>
      
    </div>
    
      <label class="md-header-nav__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5,3A6.5,6.5 0 0,1 16,9.5C16,11.11 15.41,12.59 14.44,13.73L14.71,14H15.5L20.5,19L19,20.5L14,15.5V14.71L13.73,14.44C12.59,15.41 11.11,16 9.5,16A6.5,6.5 0 0,1 3,9.5A6.5,6.5 0 0,1 9.5,3M9.5,5C7,5 5,7 5,9.5C5,12 7,14 9.5,14C12,14 14,12 14,9.5C14,7 12,5 9.5,5Z" /></svg>
      </label>
      
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" data-md-state="active">
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5,3A6.5,6.5 0 0,1 16,9.5C16,11.11 15.41,12.59 14.44,13.73L14.71,14H15.5L20.5,19L19,20.5L14,15.5V14.71L13.73,14.44C12.59,15.41 11.11,16 9.5,16A6.5,6.5 0 0,1 3,9.5A6.5,6.5 0 0,1 9.5,3M9.5,5C7,5 5,7 5,9.5C5,12 7,14 9.5,14C12,14 14,12 14,9.5C14,7 12,5 9.5,5Z" /></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20,11V13H8L13.5,18.5L12.08,19.92L4.16,12L12.08,4.08L13.5,5.5L8,11H20Z" /></svg>
      </label>
      <button type="reset" class="md-search__icon md-icon" aria-label="Clear" data-md-component="search-reset" tabindex="-1">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19,6.41L17.59,5L12,10.59L6.41,5L5,6.41L10.59,12L5,17.59L6.41,19L12,13.41L17.59,19L19,17.59L13.41,12L19,6.41Z" /></svg>
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Type to start searching
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header-nav__source">
        
<a href="https://github.com/silagokth/SiLagoDoc/" title="Go to repository" class="md-source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05L244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    silagokth/SiLagoDoc
  </div>
</a>
      </div>
    
  </nav>
</header>
    
    <div class="md-container" data-md-component="container">
      
        
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="https://silagokth.github.io/SiLagoDoc/" title="SiLago Documentation" class="md-nav__button md-logo" aria-label="SiLago Documentation">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12,8A3,3 0 0,0 15,5A3,3 0 0,0 12,2A3,3 0 0,0 9,5A3,3 0 0,0 12,8M12,11.54C9.64,9.35 6.5,8 3,8V19C6.5,19 9.64,20.35 12,22.54C14.36,20.35 17.5,19 21,19V8C17.5,8 14.36,9.35 12,11.54Z" /></svg>

    </a>
    SiLago Documentation
  </label>
  
    <div class="md-nav__source">
      
<a href="https://github.com/silagokth/SiLagoDoc/" title="Go to repository" class="md-source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05L244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    silagokth/SiLagoDoc
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item">
    <a href="../../../.." title="Home" class="md-nav__link">
      Home
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-2" type="checkbox" id="nav-2">
    
    <label class="md-nav__link" for="nav-2">
      Guideline
      <span class="md-nav__icon md-icon">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M8.59,16.58L13.17,12L8.59,7.41L10,6L16,12L10,18L8.59,16.58Z" /></svg>
      </span>
    </label>
    <nav class="md-nav" aria-label="Guideline" data-md-level="1">
      <label class="md-nav__title" for="nav-2">
        <span class="md-nav__icon md-icon">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20,11V13H8L13.5,18.5L12.08,19.92L4.16,12L12.08,4.08L13.5,5.5L8,11H20Z" /></svg>
        </span>
        Guideline
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../Guideline/Mkdocs-tutorial/" title="MkDocs Tutorial" class="md-nav__link">
      MkDocs Tutorial
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../Guideline/Style-guide-cpp/" title="C++ Style Guide" class="md-nav__link">
      C++ Style Guide
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../Guideline/Style-guide-rtl/" title="Coding Guidelines for RTL and VHDL coding" class="md-nav__link">
      Coding Guidelines for RTL and VHDL coding
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-3" type="checkbox" id="nav-3">
    
    <label class="md-nav__link" for="nav-3">
      Docs
      <span class="md-nav__icon md-icon">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M8.59,16.58L13.17,12L8.59,7.41L10,6L16,12L10,18L8.59,16.58Z" /></svg>
      </span>
    </label>
    <nav class="md-nav" aria-label="Docs" data-md-level="1">
      <label class="md-nav__title" for="nav-3">
        <span class="md-nav__icon md-icon">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20,11V13H8L13.5,18.5L12.08,19.92L4.16,12L12.08,4.08L13.5,5.5L8,11H20Z" /></svg>
        </span>
        Docs
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-3-1" type="checkbox" id="nav-3-1">
    
    <label class="md-nav__link" for="nav-3-1">
      Tool Chain
      <span class="md-nav__icon md-icon">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M8.59,16.58L13.17,12L8.59,7.41L10,6L16,12L10,18L8.59,16.58Z" /></svg>
      </span>
    </label>
    <nav class="md-nav" aria-label="Tool Chain" data-md-level="2">
      <label class="md-nav__title" for="nav-3-1">
        <span class="md-nav__icon md-icon">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20,11V13H8L13.5,18.5L12.08,19.92L4.16,12L12.08,4.08L13.5,5.5L8,11H20Z" /></svg>
        </span>
        Tool Chain
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../Overview/" title="Toolchain for SiLago Platform" class="md-nav__link">
      Toolchain for SiLago Platform
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-3-1-2" type="checkbox" id="nav-3-1-2">
    
    <label class="md-nav__link" for="nav-3-1-2">
      Vesyla-suite
      <span class="md-nav__icon md-icon">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M8.59,16.58L13.17,12L8.59,7.41L10,6L16,12L10,18L8.59,16.58Z" /></svg>
      </span>
    </label>
    <nav class="md-nav" aria-label="Vesyla-suite" data-md-level="3">
      <label class="md-nav__title" for="nav-3-1-2">
        <span class="md-nav__icon md-icon">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20,11V13H8L13.5,18.5L12.08,19.92L4.16,12L12.08,4.08L13.5,5.5L8,11H20Z" /></svg>
        </span>
        Vesyla-suite
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../Vesyla-suite/Overview/" title="Vesyla-suite Overview" class="md-nav__link">
      Vesyla-suite Overview
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Vesyla-suite/Installation/" title="Installation" class="md-nav__link">
      Installation
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Vesyla-suite/Tutorial_DRRA/" title="DRRA-based AlImp Design Tutorial (v3)" class="md-nav__link">
      DRRA-based AlImp Design Tutorial (v3)
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Vesyla-suite/Tutorial_DRRA_v2/" title="DRRA-based AlImp Design Tutorial (v2)" class="md-nav__link">
      DRRA-based AlImp Design Tutorial (v2)
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Vesyla-suite/VesylaProgrammingGuide/" title="Vesyla Programming Guide (v3)" class="md-nav__link">
      Vesyla Programming Guide (v3)
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Vesyla-suite/VesylaProgrammingGuide_v2/" title="Vesyla Programming Guide (v2)" class="md-nav__link">
      Vesyla Programming Guide (v2)
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Vesyla-suite/ManasProgrammingGuide/" title="Manas Programming Guide" class="md-nav__link">
      Manas Programming Guide
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Vesyla-suite/InstructionSet/" title="Instruction Set" class="md-nav__link">
      Instruction Set
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Vesyla-suite/InstructionPhase/" title="Instruction Phase" class="md-nav__link">
      Instruction Phase
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Vesyla-suite/Tutorial_RISCV/" title="RISCV-based AlImp Design Tutorial" class="md-nav__link">
      RISCV-based AlImp Design Tutorial
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Vesyla-suite/RepoOrganization/" title="Repo Organization" class="md-nav__link">
      Repo Organization
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
      </ul>
    </nav>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-4" type="checkbox" id="nav-4">
    
    <label class="md-nav__link" for="nav-4">
      About
      <span class="md-nav__icon md-icon">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M8.59,16.58L13.17,12L8.59,7.41L10,6L16,12L10,18L8.59,16.58Z" /></svg>
      </span>
    </label>
    <nav class="md-nav" aria-label="About" data-md-level="1">
      <label class="md-nav__title" for="nav-4">
        <span class="md-nav__icon md-icon">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20,11V13H8L13.5,18.5L12.08,19.92L4.16,12L12.08,4.08L13.5,5.5L8,11H20Z" /></svg>
        </span>
        About
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../About/About/" title="About" class="md-nav__link">
      About
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../About/License/" title="License" class="md-nav__link">
      License
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20,11V13H8L13.5,18.5L12.08,19.92L4.16,12L12.08,4.08L13.5,5.5L8,11H20Z" /></svg>
      </span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#problem-defination" class="md-nav__link">
    Problem Defination
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#problem-simplification" class="md-nav__link">
    Problem Simplification
  </a>
  
    <nav class="md-nav" aria-label="Problem Simplification">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#delay-bound-assumption" class="md-nav__link">
    Delay bound assumption
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#parking-hard-links" class="md-nav__link">
    Parking Hard-links
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#remove-redundant-edges" class="md-nav__link">
    Remove Redundant Edges
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#negative-edge-weight-adjustment" class="md-nav__link">
    Negative Edge Weight Adjustment
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#resource-hazard-prediction" class="md-nav__link">
    Resource Hazard Prediction
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#solution-space-exploration" class="md-nav__link">
    Solution Space Exploration
  </a>
  
    <nav class="md-nav" aria-label="Solution Space Exploration">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#list-scheduling-algorithm" class="md-nav__link">
    LIST Scheduling Algorithm
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                  <a href="https://github.com/silagokth/SiLagoDoc/edit/master/docs/Docs/ToolChain/Vesyla/Scheduling.md" title="Edit this page" class="md-content__button md-icon">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20.71,7.04C21.1,6.65 21.1,6 20.71,5.63L18.37,3.29C18,2.9 17.35,2.9 16.96,3.29L15.12,5.12L18.87,8.87M3,17.25V21H6.75L17.81,9.93L14.06,6.18L3,17.25Z" /></svg>
                  </a>
                
                
                  
                
                
                <h1 id="scheduling">Scheduling</h1>
<h2 id="problem-defination">Problem Defination</h2>
<p>In Vesyla, the generated instructions have fairly long life-time and are highly cooperative. Which means they are not just single-cycle actors with simple precedency relation that fight for resources. Instructions running in DRRA microthreads might actively coordinate themselves with other instructions executing in some other microthreads. Cooperation with other instructions can happen at any time when an instruction is alive and it can happen multiple times with multiple different other instructions. Further more, the life-time of an instruction in Vesyla can be undetermined and depend on other instructions in terms of both precedency relation and resource availability.</p>
<p>To simplify the scenario a little bit, we consider the <strong>critical points</strong> of those instructions as the atomic unit objects (jobs/actors/operations) that need to be scheduled in the cooperative instruction scheduling problem which will be defined later. What are the critical points? They can be starting and ending point of instructions. They can be the time points when a instruction change its resource usage. They can be the time points when a instruction need to coordinate with other instructions. In short, whenever an instruction changes anything, it's a critical point. Critical points don't have execution duration, it just represents a timestamp. However, critical points can have resoure usage attached to it. Resource usage requires time duration.</p>
<p>With the usage of critical points, a new phenominal appears. Some instructions can have undetermined life-time before scheduling. When those instructions are broken down into critical points, the resource usage of those critical points need special treatment since their usage duration are undetermined. We need to assign a <strong>LOCK</strong> resource usage frame to the critical point starting to use the resource and a <strong>KEY</strong> resource usage frame to the critical point finishing to use the resource. The resource between <strong>LOCK</strong> and <strong>KEY</strong> frame during scheding should be marked <strong>unavailable</strong> to other critical points.</p>
<p>Cooperative instruction scheduling problem thus is very different from the classic instruction scheduling problem. In classic instruction scheduling problem, either positive or negative time-lag exists between a pair of instructions. While between a cooperative critical points pair, both minimal and maximum time-lag may exist, which constrants the precedence relation to a possibly closed time frame. A special case is when minimal and maximum time-lag are equal, representing the two critical points will have an exact time difference. The introduce of <strong>LOCK</strong> and <strong>KEY</strong> frame for resource usage is also very different from conventional instruction scheduling problem.</p>
<p>Now, we formally define the scheduling model and the scheduling problem.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>MODEL AND PROBLEM DEFINATION</p>
</div>
<h2 id="problem-simplification">Problem Simplification</h2>
<p>The scheduling model defined above can not be used directly because it's high complexity creates a vast solution space and scheduling algorithm will have hard time to navigate to the correct direction.</p>
<p>Therefore, we propose one assumption and four simplification step to simplify the model. The simplification processes transform the model to equivalent but simpler model hence shrink the solution space.</p>
<h3 id="delay-bound-assumption">Delay bound assumption</h3>
<p>Delay bounds of an edge in depenency graph can be either negative or positive as long as the higher bound <span><span class="MathJax_Preview">d_h</span><script type="math/tex">d_h</script></span> is not less than lower bound <span><span class="MathJax_Preview">d_l</span><script type="math/tex">d_l</script></span>. An edge with <span><span class="MathJax_Preview">d_l=-\infty</span><script type="math/tex">d_l=-\infty</script></span> or with <span><span class="MathJax_Preview">d_l\le d_h \lt 0</span><script type="math/tex">d_l\le d_h \lt 0</script></span> can be easily converted to an edge with <span><span class="MathJax_Preview">d_l\neq -\infty</span><script type="math/tex">d_l\neq -\infty</script></span> and <span><span class="MathJax_Preview">d_h\ge 0</span><script type="math/tex">d_h\ge 0</script></span>. Therefore, we assume that: every edge in dependency graph will have a delay bounds satisfying <span><span class="MathJax_Preview">d_l\neq -\infty</span><script type="math/tex">d_l\neq -\infty</script></span>, <span><span class="MathJax_Preview">d_h\ge 0</span><script type="math/tex">d_h\ge 0</script></span> and <span><span class="MathJax_Preview">d_l\le d_h</span><script type="math/tex">d_l\le d_h</script></span>.</p>
<h3 id="parking-hard-links">Parking Hard-links</h3>
<p>Hard-links are edges with constant delay (<span><span class="MathJax_Preview">d_l=d_h</span><script type="math/tex">d_l=d_h</script></span>). For example, <span><span class="MathJax_Preview">A\xrightarrow[]{\text{[w,w]}}B</span><script type="math/tex">A\xrightarrow[]{\text{[w,w]}}B</script></span> is a hard-link, it describs the constraint that the schedule time of B is exactly <span><span class="MathJax_Preview">w</span><script type="math/tex">w</script></span> cycles after the schedule time of A.</p>
<p>All vertices linked by hard-links should be scheduled together, because if any vertex has been scheduled, the schedule time of other vertices which directly or indirectly linked to the scheduled vertex can be determined immediately. Therefore, packing hard-linked vertices together can reduce the size of graph and accelerate the scheduling process.</p>
<p>Pseudo Algorithm is shown below:</p>
<div class="highlight"><pre><span></span><code><span class="n">Graph</span> <span class="nf">packing_hard_links</span><span class="p">(</span><span class="n">Graph</span> <span class="n">g</span><span class="p">){</span>
    <span class="n">Graph</span> <span class="n">g1</span> <span class="o">=</span> <span class="n">remove_soft_links</span><span class="p">(</span><span class="n">g</span><span class="p">);</span>
    <span class="n">Component</span> <span class="n">C</span> <span class="o">=</span> <span class="n">find_connected_components</span><span class="p">(</span><span class="n">g1</span><span class="p">);</span>
    <span class="n">Graph</span> <span class="n">g2</span><span class="p">;</span>
    <span class="k">for</span><span class="p">(</span><span class="k">auto</span> <span class="nl">c</span> <span class="p">:</span> <span class="n">C</span><span class="p">){</span>
        <span class="n">vector</span><span class="o">&lt;</span><span class="n">Vertex</span><span class="p">,</span> <span class="kt">int</span><span class="o">&gt;</span> <span class="n">offset_map</span> <span class="o">=</span> <span class="n">find_offset_for_each_vertex</span><span class="p">(</span><span class="n">c</span><span class="p">);</span>
        <span class="n">Vertex</span> <span class="n">vc</span><span class="p">;</span>
        <span class="n">Graph</span> <span class="n">g3</span><span class="p">;</span>
        <span class="k">for</span><span class="p">(</span><span class="k">auto</span> <span class="nl">v</span> <span class="p">:</span> <span class="n">c</span><span class="p">.</span><span class="n">vertices</span><span class="p">()){</span>
            <span class="n">v</span><span class="p">.</span><span class="n">schedule_time</span> <span class="o">=</span> <span class="n">offset_map</span><span class="p">(</span><span class="n">v</span><span class="p">);</span>
            <span class="n">g3</span><span class="p">.</span><span class="n">add_vertex</span><span class="p">(</span><span class="n">v</span><span class="p">);</span>
        <span class="p">}</span>
        <span class="n">vc</span><span class="p">.</span><span class="n">add_child</span><span class="p">(</span><span class="n">g3</span><span class="p">)</span>
        <span class="n">g2</span><span class="p">.</span><span class="n">add_vertex</span><span class="p">(</span><span class="n">vc</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="k">for</span><span class="p">(</span><span class="k">auto</span> <span class="nl">e</span><span class="p">:</span> <span class="n">edges</span><span class="p">(</span><span class="n">g</span><span class="p">)){</span>
        <span class="k">if</span><span class="p">(</span><span class="n">is_soft_link</span><span class="p">(</span><span class="n">e</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="n">in_different_component</span><span class="p">(</span><span class="n">e</span><span class="p">.</span><span class="n">src</span><span class="p">,</span> <span class="n">e</span><span class="p">.</span><span class="n">dest</span><span class="p">)){</span>
            <span class="n">Edge</span> <span class="n">e1</span> <span class="o">=</span> <span class="n">reshape_edge_accroding_to_g2</span><span class="p">(</span><span class="n">e</span><span class="p">);</span>
            <span class="n">g2</span><span class="p">.</span><span class="n">add_edge</span><span class="p">(</span><span class="n">e1</span><span class="p">);</span>
        <span class="p">}</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="n">g2</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div>
<h3 id="remove-redundant-edges">Remove Redundant Edges</h3>
<p>When analyzing the weighted edges in dependency graph (DG), it's easy to discover that there are some edges that have very relatexed constraints which can be removed completely without loosing any synchronization constraint information of the original DG. Example below illustrate such scenario.</p>
<p>{% dot schedule_remove_redundant_edges.svg
    digraph G {
          rankdir="LR";
          u -&gt; v [label="[1, 5]"];
          u -&gt; w [label="[1, 2]"];
          w -&gt; v [label="[0, 1]"];
    }
%}</p>
<p>From the path <span><span class="MathJax_Preview">u \rightarrow v</span><script type="math/tex">u \rightarrow v</script></span>, assuming <span><span class="MathJax_Preview">u</span><script type="math/tex">u</script></span> starts at <span><span class="MathJax_Preview">t_0</span><script type="math/tex">t_0</script></span>, <span><span class="MathJax_Preview">v</span><script type="math/tex">v</script></span> should start at the time period <span><span class="MathJax_Preview">[t_0+1,t_0+5]</span><script type="math/tex">[t_0+1,t_0+5]</script></span>. While from the path <span><span class="MathJax_Preview">u \rightarrow w \rightarrow v</span><script type="math/tex">u \rightarrow w \rightarrow v</script></span>, <span><span class="MathJax_Preview">v</span><script type="math/tex">v</script></span> should start at the time period <span><span class="MathJax_Preview">[t_0+1,t_0+3]</span><script type="math/tex">[t_0+1,t_0+3]</script></span>. It's obvious that period <span><span class="MathJax_Preview">[t_0+1,t_0+5]</span><script type="math/tex">[t_0+1,t_0+5]</script></span> is more relaxed thatn period <span><span class="MathJax_Preview">[t_0+1,t_0+3]</span><script type="math/tex">[t_0+1,t_0+3]</script></span>. The path <span><span class="MathJax_Preview">u \rightarrow v</span><script type="math/tex">u \rightarrow v</script></span> doesn't add any addtition information, hence, can be removed.</p>
<h3 id="negative-edge-weight-adjustment">Negative Edge Weight Adjustment</h3>
<p>In DG, weight can be period with negative integers. Therefore, if there is an edge <span><span class="MathJax_Preview">u \xrightarrow[]{\text[-2,2]} v</span><script type="math/tex">u \xrightarrow[]{\text[-2,2]} v</script></span>, though graphically the edge point from <span><span class="MathJax_Preview">u</span><script type="math/tex">u</script></span> to <span><span class="MathJax_Preview">v</span><script type="math/tex">v</script></span>, it doesn't necessarily mean that after scheduling, <span><span class="MathJax_Preview">v</span><script type="math/tex">v</script></span> is scheduled after <span><span class="MathJax_Preview">u</span><script type="math/tex">u</script></span>. The inconsistancy between graph representation and the actual meaning of the weighted edge cause some troubles during later process. It would be much better if we can find a way to make them consistant.To adjust the weight of edges, the goal is to guarantee the weight period are strictly positive numbers.</p>
<p>Reader should keep in mind  what are the vertices in DG. They are just timestamp marking the critical time of each operation. There may be resource occupation table (ROT) attach to them. Suppose we have an edge like as following:</p>
<p>{% dot schedule_edge_weight_adjustment_0.svg
    digraph G {
          rankdir="LR";
          u [label="u"];
          v [label="v"];
          u -&gt; v [label="[-2, 2]"];
    }
%}</p>
<p>We can insert a dummy vertex <span><span class="MathJax_Preview">d</span><script type="math/tex">d</script></span> with no ROT attach to it before <span><span class="MathJax_Preview">u</span><script type="math/tex">u</script></span> with exactly 3 cycles ahead.</p>
<p>{% dot schedule_remove_edge_weight_adjustment_1.svg
    digraph G {
          rankdir="LR";
          d [label="d"];
          u [label="u"];
          v [label="v"];
          d -&gt; u [label="[3,3]"];
          u -&gt; v [label="[-2, 2]"];
    }
%}</p>
<p>The edge <span><span class="MathJax_Preview">u \rightarrow v</span><script type="math/tex">u \rightarrow v</script></span> can be replaced by a new edge <span><span class="MathJax_Preview">d \rightarrow v</span><script type="math/tex">d \rightarrow v</script></span>.</p>
<p>{% dot schedule_remove_edge_weight_adjustment_2.svg
    digraph G {
          rankdir="LR";
          d [label="d"];
          u [label="u"];
          v [label="v"];
          d -&gt; u [label="[3,3]"];
          d -&gt; v [label="[1, 5]"];
    }
%}</p>
<p>Edge <span><span class="MathJax_Preview">d \rightarrow u</span><script type="math/tex">d \rightarrow u</script></span> is always a hard edge, we can merge vertex <span><span class="MathJax_Preview">d</span><script type="math/tex">d</script></span> and <span><span class="MathJax_Preview">u</span><script type="math/tex">u</script></span> to a new vertex <span><span class="MathJax_Preview">u'</span><script type="math/tex">u'</script></span> with shifted ROT_u as its attached ROT.</p>
<p>{% dot schedule_edge_weight_adjustment_3.svg
    digraph G {
          rankdir="LR";
          u [label="u'"];
          v [label="v"];
          u -&gt; v [label="[1, 5]"];
    }
%}</p>
<p>In this way, every negative numbered weight can be converted to positive weight in DG.</p>
<h3 id="resource-hazard-prediction">Resource Hazard Prediction</h3>
<p>A well defined program will always have LOCK/KEY frame pair for any resource. A resource should never been locked and there is no KEY frame to unlock it, or vice versa. Different LOCK/KEY pair targeting the same resource will conflict with each other due to the resource occupation. The resource harzard should be resolved by scheduling via time multiplexing. However, in some scenario, if the scheduler don't schedule the vertices in a specific order, the scheduling might lead to unschduable situation due to resource occupation deadlock. Some exploration algorithms such as LIST scheduling engine might fail. While other scheduling engine such as Branch-and-Bound might stack to some corner space exploring for a very long time in order to find a valid suliton. The following example clearly shows such scenario.</p>
<p>{% dot schedule_resource_hazard_0.svg
    digraph G {
          rankdir="LR";
          a [label="a / LOCK&reg;"];
          b [label="b / KEY&reg;"];
          c [label="c / LOCK&reg;"];
          d [label="d / KEY&reg;"];
          e [label="e"];
          f [label="f"];
          g [label="g"];
          h [label="h"];
          a -&gt; b;
          c -&gt; f -&gt; g -&gt; h -&gt; d;
          b -&gt; e -&gt; d;
    }
%}</p>
<p>Vertex <span><span class="MathJax_Preview">c</span><script type="math/tex">c</script></span> can be chosen by the scheduler to schedule first because it don't have any dependency from other vertices. The naturally, <span><span class="MathJax_Preview">f, g, h</span><script type="math/tex">f, g, h</script></span> can be scheduled. But <span><span class="MathJax_Preview">d</span><script type="math/tex">d</script></span> can not be scheduled because <span><span class="MathJax_Preview">e</span><script type="math/tex">e</script></span> is not scheduled. <span><span class="MathJax_Preview">e</span><script type="math/tex">e</script></span> can not be scheduled because <span><span class="MathJax_Preview">a</span><script type="math/tex">a</script></span> can't be scheduled due to resource <span><span class="MathJax_Preview">r</span><script type="math/tex">r</script></span> is locked by <span><span class="MathJax_Preview">c</span><script type="math/tex">c</script></span>. And <span><span class="MathJax_Preview">r</span><script type="math/tex">r</script></span> is not can't be freed because <span><span class="MathJax_Preview">d</span><script type="math/tex">d</script></span> can't be scheduled. This is a deadlock and will make this scheduling unfeasible. In order to correct the mistake, the scheduler (for example Branch-and-Bound) will try to trace back and to the step of scheduling <span><span class="MathJax_Preview">h</span><script type="math/tex">h</script></span>, then trace back again to <span><span class="MathJax_Preview">g</span><script type="math/tex">g</script></span>. Until it back-tracks to <span><span class="MathJax_Preview">c</span><script type="math/tex">c</script></span>, the very first scheduling step, the scheduler can't correct the mistake.</p>
<p>To solve such problem, we need to predict the scheduling order. By analyzing the graph structure, we should be able to conclude that <span><span class="MathJax_Preview">c</span><script type="math/tex">c</script></span> should be scheduled after than <span><span class="MathJax_Preview">b</span><script type="math/tex">b</script></span>. We then force a constraint edge to explictly represent such scheduling order in order to help the later exploring phase. The dependency graph after hazard prediction will be look like this:</p>
<p>{% dot schedule_resource_hazard_0.svg
    digraph G {
          rankdir="LR";
          a [label="a / LOCK&reg;"];
          b [label="b / KEY&reg;"];
          c [label="c / LOCK&reg;"];
          d [label="d / KEY&reg;"];
          e [label="e"];
          f [label="f"];
          g [label="g"];
          h [label="h"];
          a -&gt; b;
          c -&gt; f -&gt; g -&gt; h -&gt; d;
          b -&gt; e -&gt; d;
          b -&gt; c;
    }
%}</p>
<h2 id="solution-space-exploration">Solution Space Exploration</h2>
<p>Scheduling is an NP-Complete problem. To find a valid solution for dependency graph, we need some solution searching engine or hierustic scheduling algorithm. Branch-and-Bound, Constriant Programming, LIST algorithm, Simulated Annening, etc are such searching engines. In this section, we introduce two searching engine as an example to demonstrate how does the solution space exploration works.</p>
<h3 id="list-scheduling-algorithm">LIST Scheduling Algorithm</h3>
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
        Made with
        <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
          Material for MkDocs
        </a>
      </div>
      
    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../../../../assets/javascripts/vendor.606193c2.min.js"></script>
      <script src="../../../../assets/javascripts/bundle.b90b6d1d.min.js"></script><script id="__lang" type="application/json">{"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents"}</script>
      
      <script>
        app = initialize({
          base: "../../../..",
          features: [],
          search: Object.assign({
            worker: "../../../../assets/javascripts/worker/search.7f7c8775.min.js"
          }, typeof search !== "undefined" && search)
        })
      </script>
      
        <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-MML-AM_CHTML"></script>
      
    
  </body>
</html>